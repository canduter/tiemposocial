/* automatically generated by JSCoverage - do not edit */
if (typeof _$jscoverage === 'undefined') _$jscoverage = {};
if (! _$jscoverage['twitterfeeder.js']) {
  _$jscoverage['twitterfeeder.js'] = [];
  _$jscoverage['twitterfeeder.js'][1] = 0;
  _$jscoverage['twitterfeeder.js'][2] = 0;
  _$jscoverage['twitterfeeder.js'][3] = 0;
  _$jscoverage['twitterfeeder.js'][4] = 0;
  _$jscoverage['twitterfeeder.js'][9] = 0;
  _$jscoverage['twitterfeeder.js'][10] = 0;
  _$jscoverage['twitterfeeder.js'][11] = 0;
  _$jscoverage['twitterfeeder.js'][12] = 0;
  _$jscoverage['twitterfeeder.js'][16] = 0;
  _$jscoverage['twitterfeeder.js'][18] = 0;
  _$jscoverage['twitterfeeder.js'][19] = 0;
  _$jscoverage['twitterfeeder.js'][22] = 0;
  _$jscoverage['twitterfeeder.js'][24] = 0;
  _$jscoverage['twitterfeeder.js'][25] = 0;
  _$jscoverage['twitterfeeder.js'][26] = 0;
  _$jscoverage['twitterfeeder.js'][27] = 0;
  _$jscoverage['twitterfeeder.js'][29] = 0;
  _$jscoverage['twitterfeeder.js'][31] = 0;
  _$jscoverage['twitterfeeder.js'][37] = 0;
  _$jscoverage['twitterfeeder.js'][41] = 0;
  _$jscoverage['twitterfeeder.js'][45] = 0;
  _$jscoverage['twitterfeeder.js'][51] = 0;
  _$jscoverage['twitterfeeder.js'][52] = 0;
  _$jscoverage['twitterfeeder.js'][53] = 0;
  _$jscoverage['twitterfeeder.js'][55] = 0;
  _$jscoverage['twitterfeeder.js'][56] = 0;
  _$jscoverage['twitterfeeder.js'][61] = 0;
  _$jscoverage['twitterfeeder.js'][63] = 0;
  _$jscoverage['twitterfeeder.js'][64] = 0;
  _$jscoverage['twitterfeeder.js'][65] = 0;
  _$jscoverage['twitterfeeder.js'][66] = 0;
  _$jscoverage['twitterfeeder.js'][67] = 0;
  _$jscoverage['twitterfeeder.js'][68] = 0;
  _$jscoverage['twitterfeeder.js'][72] = 0;
  _$jscoverage['twitterfeeder.js'][73] = 0;
  _$jscoverage['twitterfeeder.js'][77] = 0;
  _$jscoverage['twitterfeeder.js'][79] = 0;
  _$jscoverage['twitterfeeder.js'][83] = 0;
  _$jscoverage['twitterfeeder.js'][84] = 0;
  _$jscoverage['twitterfeeder.js'][87] = 0;
  _$jscoverage['twitterfeeder.js'][88] = 0;
  _$jscoverage['twitterfeeder.js'][93] = 0;
  _$jscoverage['twitterfeeder.js'][95] = 0;
  _$jscoverage['twitterfeeder.js'][96] = 0;
  _$jscoverage['twitterfeeder.js'][98] = 0;
  _$jscoverage['twitterfeeder.js'][99] = 0;
  _$jscoverage['twitterfeeder.js'][100] = 0;
  _$jscoverage['twitterfeeder.js'][102] = 0;
  _$jscoverage['twitterfeeder.js'][103] = 0;
  _$jscoverage['twitterfeeder.js'][104] = 0;
  _$jscoverage['twitterfeeder.js'][108] = 0;
  _$jscoverage['twitterfeeder.js'][112] = 0;
  _$jscoverage['twitterfeeder.js'][113] = 0;
  _$jscoverage['twitterfeeder.js'][114] = 0;
  _$jscoverage['twitterfeeder.js'][115] = 0;
  _$jscoverage['twitterfeeder.js'][116] = 0;
  _$jscoverage['twitterfeeder.js'][117] = 0;
  _$jscoverage['twitterfeeder.js'][118] = 0;
  _$jscoverage['twitterfeeder.js'][120] = 0;
  _$jscoverage['twitterfeeder.js'][124] = 0;
}
_$jscoverage['twitterfeeder.js'][1]++;
var events = require("events");
_$jscoverage['twitterfeeder.js'][2]++;
var http = require("http");
_$jscoverage['twitterfeeder.js'][3]++;
var EventEmitter = require("events").EventEmitter;
_$jscoverage['twitterfeeder.js'][4]++;
var TwitterNode = require("twitter-node").TwitterNode, Common = require("./common"), Tools = Common.tools;
_$jscoverage['twitterfeeder.js'][9]++;
var TwitterFeeder = (function (twitterNode) {
  _$jscoverage['twitterfeeder.js'][10]++;
  EventEmitter.call(this);
  _$jscoverage['twitterfeeder.js'][11]++;
  this.twitterNode = twitterNode;
  _$jscoverage['twitterfeeder.js'][12]++;
  this.onTweet = Tools.bind(this.onTweet, this);
});
_$jscoverage['twitterfeeder.js'][16]++;
TwitterFeeder.prototype = Object.create(EventEmitter.prototype);
_$jscoverage['twitterfeeder.js'][18]++;
TwitterFeeder.prototype.endStream = (function () {
  _$jscoverage['twitterfeeder.js'][19]++;
  this.twitterNode.removeListener("tweet", this.onTweet);
});
_$jscoverage['twitterfeeder.js'][22]++;
TwitterFeeder.prototype.searchByName = (function (placeName, lat, lng) {
  _$jscoverage['twitterfeeder.js'][24]++;
  var self = this;
  _$jscoverage['twitterfeeder.js'][25]++;
  this.placeName = placeName;
  _$jscoverage['twitterfeeder.js'][26]++;
  this.lat = lat;
  _$jscoverage['twitterfeeder.js'][27]++;
  this.lng = lng;
  _$jscoverage['twitterfeeder.js'][29]++;
  this.twitterNode.addListener("error", (function (error) {
  _$jscoverage['twitterfeeder.js'][31]++;
  console.log(error.message);
})).addListener("tweet", this.onTweet).addListener("limit", (function (limit) {
  _$jscoverage['twitterfeeder.js'][37]++;
  sys.puts("LIMIT: " + sys.inspect(limit));
})).addListener("delete", (function (del) {
  _$jscoverage['twitterfeeder.js'][41]++;
  sys.puts("DELETE: " + sys.inspect(del));
})).addListener("end", (function (resp) {
  _$jscoverage['twitterfeeder.js'][45]++;
  sys.puts("wave goodbye..." + resp.statusCode);
})).stream();
});
_$jscoverage['twitterfeeder.js'][51]++;
TwitterFeeder.prototype.onTweet = (function (tweet) {
  _$jscoverage['twitterfeeder.js'][52]++;
  if (this.tweetContainsPlaceName(tweet, this.placeName)) {
    _$jscoverage['twitterfeeder.js'][53]++;
    this.emit("tweet", JSON.stringify(tweet));
  }
  else {
    _$jscoverage['twitterfeeder.js'][55]++;
    if (this.tweetIsLocatedNear(tweet, this.lat, this.lng)) {
      _$jscoverage['twitterfeeder.js'][56]++;
      this.emit("tweet", JSON.stringify(tweet));
    }
  }
});
_$jscoverage['twitterfeeder.js'][61]++;
TwitterFeeder.prototype.tweetContainsPlaceName = (function (tweet, placeName) {
  _$jscoverage['twitterfeeder.js'][63]++;
  var text = this.simplifyString(tweet.text);
  _$jscoverage['twitterfeeder.js'][64]++;
  var userName = this.simplifyString(tweet.user.screen_name);
  _$jscoverage['twitterfeeder.js'][65]++;
  var locationName = "";
  _$jscoverage['twitterfeeder.js'][66]++;
  var userLocation = "";
  _$jscoverage['twitterfeeder.js'][67]++;
  if (tweet.place && tweet.place.full_name) {
    _$jscoverage['twitterfeeder.js'][68]++;
    locationName = this.simplifyString(tweet.place.full_name);
  }
  _$jscoverage['twitterfeeder.js'][72]++;
  if (tweet.user.location) {
    _$jscoverage['twitterfeeder.js'][73]++;
    userLocation = this.simplifyString(tweet.user.location);
  }
  _$jscoverage['twitterfeeder.js'][77]++;
  placeName = this.simplifyString(placeName);
  _$jscoverage['twitterfeeder.js'][79]++;
  if (Tools.stringContains(text, placeName) || Tools.stringContains(locationName, placeName) || Tools.stringContains(userName, placeName) || Tools.stringContains(userLocation, placeName)) {
    _$jscoverage['twitterfeeder.js'][83]++;
    console.log(">>>>>>> !!!!!!!!!!TWEET RELATED con " + placeName);
    _$jscoverage['twitterfeeder.js'][84]++;
    return true;
  }
  _$jscoverage['twitterfeeder.js'][87]++;
  console.log("NOT ABOUT " + placeName);
  _$jscoverage['twitterfeeder.js'][88]++;
  return false;
});
_$jscoverage['twitterfeeder.js'][93]++;
TwitterFeeder.prototype.tweetIsLocatedNear = (function (tweet, lat, lng) {
  _$jscoverage['twitterfeeder.js'][95]++;
  var r = 3;
  _$jscoverage['twitterfeeder.js'][96]++;
  if (tweet.geo && tweet.geo.coordinates) {
    _$jscoverage['twitterfeeder.js'][98]++;
    console.log(">>> Found coordinates!!!!!!! " + tweet.geo.coordinates);
    _$jscoverage['twitterfeeder.js'][99]++;
    var thisLat = tweet.geo.coordinates[0];
    _$jscoverage['twitterfeeder.js'][100]++;
    var thisLng = tweet.geo.coordinates[1];
    _$jscoverage['twitterfeeder.js'][102]++;
    if (thisLat >= lat - r && thisLat <= lat + r && thisLng >= lng - r && thisLng <= lng + r) {
      _$jscoverage['twitterfeeder.js'][103]++;
      console.log(">>>>>>> !!!!!!!!!! Found nearby location!!!!!!!");
      _$jscoverage['twitterfeeder.js'][104]++;
      return true;
    }
  }
  _$jscoverage['twitterfeeder.js'][108]++;
  return false;
});
_$jscoverage['twitterfeeder.js'][112]++;
TwitterFeeder.prototype.simplifyString = (function (string) {
  _$jscoverage['twitterfeeder.js'][113]++;
  string = string.replace("\u00c3\u00a1", "a");
  _$jscoverage['twitterfeeder.js'][114]++;
  string = string.replace("\u00c3\u00a9", "e");
  _$jscoverage['twitterfeeder.js'][115]++;
  string = string.replace("\u00c3\u00ad", "i");
  _$jscoverage['twitterfeeder.js'][116]++;
  string = string.replace("\u00c3\u00b3", "o");
  _$jscoverage['twitterfeeder.js'][117]++;
  string = string.replace("\u00c3\u00ba", "u");
  _$jscoverage['twitterfeeder.js'][118]++;
  string = string.toLowerCase();
  _$jscoverage['twitterfeeder.js'][120]++;
  return string;
});
_$jscoverage['twitterfeeder.js'][124]++;
module.exports = TwitterFeeder;
_$jscoverage['twitterfeeder.js'].source = ["var events = require('events');","var http = require('http');","var EventEmitter = require('events').EventEmitter;","var TwitterNode = require(\"twitter-node\").TwitterNode,","\tCommon = require('./common'),","\tTools = Common.tools;","","","var TwitterFeeder = function(twitterNode){","\tEventEmitter.call(this);\t","\tthis.twitterNode = twitterNode;","\tthis.onTweet = Tools.bind(this.onTweet, this);","\t","};","","TwitterFeeder.prototype = Object.create(EventEmitter.prototype);","","TwitterFeeder.prototype.endStream = function() {","\tthis.twitterNode.removeListener('tweet', this.onTweet);\t","}","","TwitterFeeder.prototype.searchByName = function(placeName, lat, lng) {\t","","\tvar self = this;","\tthis.placeName = placeName;","\tthis.lat = lat;","\tthis.lng = lng;","\t\t","\tthis.twitterNode","\t.addListener('error', function(error){","\t\tconsole.log(error.message); ","\t})","","\t.addListener('tweet', this.onTweet)","","\t.addListener('limit', function(limit){","\t\tsys.puts('LIMIT: ' + sys.inspect(limit));","\t})","","\t.addListener('delete', function(del){","\t\tsys.puts('DELETE: ' + sys.inspect(del));","\t})","","\t.addListener('end', function(resp){","\t\tsys.puts('wave goodbye...' + resp.statusCode);","\t})","","\t.stream();","};","","TwitterFeeder.prototype.onTweet = function(tweet) {","\tif(this.tweetContainsPlaceName(tweet,this.placeName))\t\t","\t\t\tthis.emit('tweet', JSON.stringify(tweet));","\telse ","\tif(this.tweetIsLocatedNear(tweet,this.lat,this.lng))\t\t","\t\t\tthis.emit('tweet', JSON.stringify(tweet));","}","","","","TwitterFeeder.prototype.tweetContainsPlaceName = function(tweet,placeName) {","","\tvar text = this.simplifyString(tweet.text);","\tvar userName = this.simplifyString(tweet.user.screen_name);","\tvar locationName = '';","\tvar userLocation = '';","\tif(tweet.place &amp;&amp; tweet.place.full_name){","\t\tlocationName = this.simplifyString(tweet.place.full_name);","\t\t//console.log(locationName);","\t}","\t","\tif(tweet.user.location){","\t\tuserLocation = this.simplifyString(tweet.user.location);","\t\t//console.log('User location: ' + userLocation);","\t}","\t\t","\tplaceName = this.simplifyString(placeName);","\t","\tif (Tools.stringContains(text,placeName) ||","\t\tTools.stringContains(locationName,placeName) ||","\t\tTools.stringContains(userName,placeName) ||","\t\tTools.stringContains(userLocation,placeName)){\t\t\t","\t\tconsole.log('&gt;&gt;&gt;&gt;&gt;&gt;&gt; !!!!!!!!!!TWEET RELATED con ' + placeName);","\t\treturn true;","\t}","\t","\tconsole.log('NOT ABOUT ' + placeName); //+'('+text+')');","\treturn false;","}","","","","TwitterFeeder.prototype.tweetIsLocatedNear = function(tweet,lat,lng) {","","\tvar r = 3; //margin in degrees","\tif(tweet.geo &amp;&amp; tweet.geo.coordinates)","\t{","\t\tconsole.log('&gt;&gt;&gt; Found coordinates!!!!!!! ' + tweet.geo.coordinates);","\t\tvar thisLat = tweet.geo.coordinates[0];","\t\tvar thisLng = tweet.geo.coordinates[1];","\t\t","\t\tif(thisLat &gt;= lat-r &amp;&amp; thisLat &lt;= lat+r &amp;&amp; thisLng &gt;= lng-r &amp;&amp; thisLng &lt;= lng+r){","\t\t\tconsole.log('&gt;&gt;&gt;&gt;&gt;&gt;&gt; !!!!!!!!!! Found nearby location!!!!!!!');","\t\t\treturn true;","\t\t}","\t}","\t//console.log('Not this location');","\treturn false;","}","","","TwitterFeeder.prototype.simplifyString = function(string) {","\tstring = string.replace(\"&#195;&#161;\", \"a\");","\tstring = string.replace(\"&#195;&#169;\", \"e\");","\tstring = string.replace(\"&#195;&#173;\", \"i\");","\tstring = string.replace(\"&#195;&#179;\", \"o\");","\tstring = string.replace(\"&#195;&#186;\", \"u\");","\tstring = string.toLowerCase();","\t","\treturn string;\t","};","","","module.exports = TwitterFeeder;"];
